<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <title>Birgit Matthias – CMS</title>
    <script src="https://unpkg.com/netlify-identity-widget@1.9.0/build/netlify-identity-widget.min.js"></script>
    <script src="https://unpkg.com/decap-cms@3.1.3/dist/decap-cms.js"></script>
    <style>
      body {
        font-family: sans-serif;
        text-align: center;
        padding: 2rem;
        color: #333;
      }
    </style>
  </head>
  <body>
    <div id="login-container">
      <h2>Bitte melden Sie sich an</h2>
      <button id="login-button">Login</button>
    </div>
    <div id="cms-container" style="display:none;">
      <h1>CMS wird geladen...</h1>
    </div>
    <script>
      const identity = netlifyIdentity.init();

      // Si hay token de invitación en URL, que lo maneje el widget
      identity.on('init', user => {
        if (!user && window.location.hash.includes('#invite_token=')) {
          identity.open('invite');
        }
      });

      // Login manual
      document.getElementById('login-button').onclick = () => {
        identity.open('login');
      };

      // Cuando el usuario inicia sesión, muestra el CMS
      identity.on('login', () => {
        document.getElementById('login-container').style.display = 'none';
        document.getElementById('cms-container').style.display = 'block';
        CMS.init();
      });

      identity.on('logout', () => {
        window.location.reload();
      });
    </script>
  </body>
</html>
